"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[229],{229:function(e,t,r){r.r(t),r.d(t,{default:function(){return I}});var n=r(74165),a=r(15861),s=r(1413),i=r(29439),d=r(47313),l=r(58467),u=r(34491),c=r(18197),o=r(77181),m=r(68197),p=r(59624),h=r(74294),f=r(6289),Z=r(99096),x=r(59491),v=r(70816),j=r.n(v),g=r(2717),b=r(90954),y=r(57409),Y=r(69660),q=r(89281),w=r(18333),D=r(24511),M=r(37889),N=r(46417);function I(){var e,t,r=(0,D.$)().t,v=(0,g.v9)((function(e){return e.menu}),g.wU).activeMenu,I=(0,g.I0)(),k=c.Z.useForm(),S=(0,i.Z)(k,1)[0],O=(0,l.s0)(),F=(0,d.useState)(!1),U=(0,i.Z)(F,2),_=U[0],A=U[1],C=(0,g.v9)((function(e){return e.myShop}),g.wU).myShop,J=(0,d.useState)(null!==(e=v.data)&&void 0!==e&&e.images?[null===(t=v.data)||void 0===t?void 0:t.images[0]]:[]),L=(0,i.Z)(J,2),V=L[0],E=L[1];(0,d.useEffect)((function(){return function(){var e=S.getFieldsValue(!0),t=JSON.stringify(e.start),r=JSON.stringify(e.end),n=(0,s.Z)((0,s.Z)({},e),{},{start:t,end:r});I((0,b.nc)({activeMenu:v,data:n}))}}),[]);function T(){return(T=(0,a.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={search:t,shop_id:C.id,status:"published",active:1,rest:1},e.abrupt("return",w.Z.getAll(r).then((function(e){return e.data.map((function(e){var t;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id}}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,N.jsx)(o.Z,{title:r("add.discount"),className:"h-100",children:(0,N.jsxs)(c.Z,{name:"discount-add",layout:"vertical",onFinish:function(e){var t,n={price:e.price,type:e.type,products:e.products.map((function(e){return e.value})),start:e.start?j()(e.start).format("YYYY-MM-DD"):void 0,end:e.end?j()(e.end).format("YYYY-MM-DD"):void 0,images:[null===(t=V[0])||void 0===t?void 0:t.name]};A(!0);var a="seller/discounts";y.Z.create(n).then((function(){u.Am.success(r("successfully.created")),I((0,b.ph)((0,s.Z)((0,s.Z)({},v),{},{nextUrl:a}))),O("/".concat(a)),I((0,Y.k)({}))})).finally((function(){return A(!1)}))},form:S,initialValues:(0,s.Z)({},function(){var e,t=v.data;if(null===(e=v.data)||void 0===e||!e.start)return t;var r=v.data.start,n=v.data.end;return(0,s.Z)((0,s.Z)({},t),{},{start:j()(r,"YYYY-MM-DD"),end:j()(n,"YYYY-MM-DD")})}()),className:"d-flex flex-column h-100",children:[(0,N.jsxs)(m.Z,{gutter:12,children:[(0,N.jsx)(p.Z,{span:12,children:(0,N.jsx)(c.Z.Item,{label:r("type"),name:"type",rules:[{required:!0,message:r("required")}],children:(0,N.jsxs)(h.Z,{children:[(0,N.jsx)(h.Z.Option,{value:"fix",children:r("fix")}),(0,N.jsx)(h.Z.Option,{value:"percent",children:r("percent")})]})})}),(0,N.jsx)(p.Z,{span:12,children:(0,N.jsx)(c.Z.Item,{label:r("price"),name:"price",rules:[{required:!0,message:r("required")}],children:(0,N.jsx)(f.Z,{min:0,className:"w-100"})})}),(0,N.jsx)(p.Z,{span:12,children:(0,N.jsx)(c.Z.Item,{label:r("start.date"),name:"start",rules:[{required:!0,message:r("required")}],children:(0,N.jsx)(Z.Z,{className:"w-100",placeholder:"",disabledDate:function(e){return j()().add(-1,"days")>=e}})})}),(0,N.jsx)(p.Z,{span:12,children:(0,N.jsx)(c.Z.Item,{label:r("end.date"),name:"end",rules:[{required:!0,message:r("required")}],children:(0,N.jsx)(Z.Z,{className:"w-100",placeholder:"",disabledDate:function(e){return j()().add(-1,"days")>=e}})})}),(0,N.jsx)(p.Z,{span:24,children:(0,N.jsx)(c.Z.Item,{label:r("products"),name:"products",rules:[{required:!0,message:r("required")}],children:(0,N.jsx)(q.h,{fetchOptions:function(e){return T.apply(this,arguments)},mode:"multiple"})})}),(0,N.jsx)(p.Z,{span:24,children:(0,N.jsx)(c.Z.Item,{label:r("image"),name:"image",rules:[{required:!V.length,message:r("required")}],children:(0,N.jsx)(M.Z,{type:"discounts",imageList:V,setImageList:E,form:S,multiple:!1,name:"image"})})})]}),(0,N.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,N.jsx)("div",{className:"pb-5",children:(0,N.jsx)(x.Z,{type:"primary",htmlType:"submit",loading:_,children:r("submit")})})})]})})}}}]);