"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[8115],{48115:function(e,t,n){n.r(t);var r=n(4942),i=n(93433),s=n(1413),a=n(29439),u=n(47313),l=n(58467),c=n(34491),o=n(18197),d=n(77181),f=n(68197),m=n(59624),p=n(59491),h=n(2717),v=n(90954),Z=n(18333),x=n(89281),j=n(24511),g=n(4446),b=n(84980),y=n(21249),w=n(46417);t.default=function(){var e,t,n=(0,j.$)().t,F=(0,h.v9)((function(e){return e.menu}),h.wU).activeMenu,S=(0,h.I0)(),_=o.Z.useForm(),k=(0,a.Z)(_,1)[0],N=(0,l.s0)(),L=(0,h.v9)((function(e){return e.myShop}),h.wU).myShop,q=(0,u.useState)(null!==(e=F.data)&&void 0!==e&&e.images?[null===(t=F.data)||void 0===t?void 0:t.images[0]]:[]),O=(0,a.Z)(q,2),U=O[0],I=O[1],R=(0,u.useState)(!1),T=(0,a.Z)(R,2),A=T[0],C=T[1];(0,u.useEffect)((function(){return function(){var e=k.getFieldsValue(!0);S((0,v.nc)({activeMenu:F,data:e}))}}),[]);return(0,w.jsx)(d.Z,{title:n("add.story"),className:"h-100",children:(0,w.jsxs)(o.Z,{name:"story-add",layout:"vertical",onFinish:function(e){var t=(0,s.Z)((0,s.Z)({},Object.assign.apply(Object,[{}].concat((0,i.Z)(U.map((function(e,t){return(0,r.Z)({},"file_urls[".concat(t,"]"),e.name)})))))),{},{product_id:e.products.value});C(!0);var a="seller/stories";g.Z.create(t).then((function(){var e={shop_id:L.id};c.Am.success(n("successfully.created")),S((0,v.ph)((0,s.Z)((0,s.Z)({},F),{},{nextUrl:a}))),N("/".concat(a)),S((0,b.U7)(e))})).finally((function(){return C(!1)}))},form:k,initialValues:(0,s.Z)({active:!0},F.data),className:"d-flex flex-column h-100",children:[(0,w.jsxs)(f.Z,{gutter:12,children:[(0,w.jsx)(m.Z,{span:24,children:(0,w.jsx)(o.Z.Item,{label:n("image"),name:"image",rules:[{required:U.length<0,message:n("required")}],children:(0,w.jsx)(y.Z,{form:k,setFileList:I,fileList:U})})}),(0,w.jsx)(m.Z,{span:24,children:(0,w.jsx)(o.Z.Item,{label:n("products"),name:"products",rules:[{required:!0,message:n("required")}],children:(0,w.jsx)(x.h,{fetchOptions:function(e){var t={search:e,shop_id:L.id,status:"published",active:1,rest:1};return Z.Z.getAll(t).then((function(e){return e.data.map((function(e){return{label:e.translation.title,value:e.id}}))}))},debounceTimeout:200})})})]}),(0,w.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,w.jsx)("div",{className:"pb-5",children:(0,w.jsx)(p.Z,{type:"primary",htmlType:"submit",loading:A,children:n("submit")})})})]})})}},21249:function(e,t,n){n.d(t,{Z:function(){return Z}});var r=n(93433),i=n(74165),s=n(15861),a=n(29439),u=n(47313),l=n(72652),c=n(15178),o=n(84695),d=n(82138),f=n(24511),m=n(34344),p={upload:function(e){return m.Z.post("dashboard/seller/stories/upload",e)}},h=n(46417),v=function(e){return new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return t(r.result)},r.onerror=function(e){return n(e)}}))},Z=function(e){var t=e.fileList,n=e.setFileList,m=e.form,Z=(0,f.$)().t,x=(0,u.useState)(!1),j=(0,a.Z)(x,2),g=j[0],b=j[1],y=(0,u.useState)(""),w=(0,a.Z)(y,2),F=w[0],S=w[1],_=(0,u.useState)(""),k=(0,a.Z)(_,2),N=k[0],L=k[1],q=(0,u.useState)(!1),O=(0,a.Z)(q,2),U=O[0],I=O[1],R=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,v(t.originFileObj);case 3:t.preview=e.sent;case 4:S(t.url||t.preview),b(!0),L(t.name||t.url.substring(t.url.lastIndexOf("/")+1));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(e){return{uid:e[0],name:e[0],status:"done",url:e[0],created:!0}},A=U?(0,h.jsx)("div",{children:(0,h.jsx)(l.Z,{})}):(0,h.jsxs)("div",{children:[(0,h.jsx)(d.Z,{className:"upload_plus"}),(0,h.jsx)("div",{style:{marginTop:8},children:(0,h.jsx)("span",{className:"upload_text",children:Z("upload")})})]});return(0,h.jsxs)("div",{className:"story_img",children:[(0,h.jsx)(c.Z,{listType:"picture-card",fileList:t,onPreview:R,customRequest:function(e){var i=e.file,s=e.onSuccess;I(!0);var a=new FormData;a.append("files[0]",i),p.upload(a).then((function(e){var i=e.data;n((function(e){return[].concat((0,r.Z)(e),[T(i)])})),m.setFieldsValue({images:[].concat((0,r.Z)(t),[T(i)])}),s("ok")})).finally((function(){I(!1)}))},onRemove:function(e){n((function(t){return t.filter((function(t){return t.uid!==e.uid}))}))},children:t.length>=24?null:A}),(0,h.jsx)(o.Z,{visible:g,title:N,footer:null,onCancel:function(){return b(!1)},children:(0,h.jsx)("img",{alt:"example",style:{width:"100%"},src:F})})]})}}}]);