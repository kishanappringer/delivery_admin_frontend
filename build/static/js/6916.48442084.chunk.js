"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[6916],{46916:function(e,n,t){t.r(n);var r=t(1413),i=t(93433),a=t(4942),l=t(29439),s=t(47313),u=t(18197),c=t(77181),d=t(68197),o=t(59624),Z=t(66672),m=t(74294),p=t(99096),h=t(6289),f=t(59491),x=t(73431),j=t(58467),b=t(23861),v=t(70816),y=t.n(v),g=t(2717),q=t(90954),_=t(24511),w=t(51353),I=t(46417);n.default=function(){var e=(0,_.$)().t,n=u.Z.useForm(),t=(0,l.Z)(n,1)[0],v=(0,s.useState)({}),Y=(0,l.Z)(v,2),U=Y[0],D=Y[1],M=(0,s.useState)(!1),N=(0,l.Z)(M,2),O=N[0],S=N[1],k=(0,s.useState)(!1),F=(0,l.Z)(k,2),C=F[0],L=F[1],V=(0,g.v9)((function(e){return e.formLang}),g.wU),A=V.defaultLang,B=V.languages,E=(0,g.I0)(),T=(0,j.s0)(),$=(0,j.UO)().id,z=(0,g.v9)((function(e){return e.menu}),g.wU).activeMenu,G=(0,g.v9)((function(e){return e.myShop}),g.wU).myShop;function H(e){S(!0),b.Z.getById(e).then((function(e){var n=e.data;D(n),t.setFieldsValue((0,r.Z)((0,r.Z)({},function(e){if(null===e||void 0===e||!e.translations)return{};var n=e.translations,t=B.map((function(e){var t;return(0,a.Z)({},"title[".concat(e.locale,"]"),null===(t=n.find((function(n){return n.locale===e.locale})))||void 0===t?void 0:t.title)}));return Object.assign.apply(Object,[{}].concat((0,i.Z)(t)))}(n)),{},{expired_at:y()(n.expired_at,"YYYY-MM-DD")}))})).finally((function(){S(!1),E((0,q.A_)(z))}))}return(0,s.useEffect)((function(){z.refetch&&H($)}),[z.refetch]),(0,I.jsx)(c.Z,{title:e("edit.coupon"),extra:(0,I.jsx)(x.Z,{}),loading:O,children:(0,I.jsxs)(u.Z,{form:t,name:"basic",initialValues:(0,r.Z)({},U),layout:"vertical",onFinish:function(e){L(!0);var n=(0,r.Z)((0,r.Z)({},e),{},{shop_id:null===G||void 0===G?void 0:G.id,expired_at:y()(e.expired_at).format("YYYY-MM-DD"),qty:Number(e.qty),price:Number(e.price)}),t="coupons";$?b.Z.update($,n).then((function(e){E((0,q.ph)((0,r.Z)((0,r.Z)({},z),{},{nextUrl:t}))),T("/".concat(t)),E((0,w.v)())})).finally((function(){return L(!1)})):b.Z.create(n).then((function(e){E((0,q.ph)((0,r.Z)((0,r.Z)({},z),{},{nextUrl:t}))),T("/".concat(t))})).finally((function(){return L(!1)}))},children:[(0,I.jsxs)(d.Z,{gutter:12,children:[(0,I.jsx)(o.Z,{span:12,children:B.map((function(n){return(0,I.jsx)(u.Z.Item,{label:e("title"),name:"title[".concat(n.locale,"]"),rules:[{required:n.locale===A,message:e("required")}],hidden:n.locale!==A,children:(0,I.jsx)(Z.Z,{})},"title"+n.id)}))}),(0,I.jsx)(o.Z,{span:12,children:(0,I.jsx)(u.Z.Item,{label:e("name"),name:"name",rules:[{required:!0,message:e("required")}],children:(0,I.jsx)(Z.Z,{})})}),(0,I.jsx)(o.Z,{span:12,children:(0,I.jsx)(u.Z.Item,{label:e("type"),name:"type",rules:[{required:!0,message:e("required")}],children:(0,I.jsxs)(m.Z,{children:[(0,I.jsx)(m.Z.Option,{value:"fix",children:e("fix")}),(0,I.jsx)(m.Z.Option,{value:"percent",children:e("percent")})]})})}),(0,I.jsx)(o.Z,{span:12,children:(0,I.jsx)(u.Z.Item,{name:"expired_at",label:e("expired.at"),rules:[{required:!0,message:e("required")}],children:(0,I.jsx)(p.Z,{className:"w-100",placeholder:"",disabledDate:function(e){return y()().add(-1,"days")>=e}})})}),(0,I.jsx)(o.Z,{span:12,children:(0,I.jsx)(u.Z.Item,{label:e("quantity"),name:"qty",rules:[{required:!0,message:e("required")}],children:(0,I.jsx)(h.Z,{min:0,className:"w-100"})})}),(0,I.jsx)(o.Z,{span:12,children:(0,I.jsx)(u.Z.Item,{label:e("price"),name:"price",rules:[{required:!0,message:e("required")}],children:(0,I.jsx)(h.Z,{min:0,className:"w-100"})})})]}),(0,I.jsx)(f.Z,{type:"primary",htmlType:"submit",loading:C,children:e("submit")})]})})}}}]);